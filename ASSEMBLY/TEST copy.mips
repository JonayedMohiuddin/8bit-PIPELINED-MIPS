# 0($io) => X ENABLE + DATA
# 1($io) => Y ENABLE + DATA
# 2($io) => UPDATE FLAG
# 3($io) => FLUSH FLAG
# 4($io) => KEYBOARD INPUT
# 15($io) => RAND INPUT

# zero
# t0 t1 t2 t3 t4
# s0 s1 s2 s3 
# a0 a1
# v0 v1
# io 
# sp

# x is 5 bit and y is 4 bit

# s0 = direction of snake head
# 0 = UP, 1 = RIGHT, 2 = DOWN, 3 = LEFT
# s1 = score
# s2 = x of food
# s3 = y of food

# t3 = head 
# t4 = tail

# SNAKE BODY MEMORY MAP:
# 176 to 239

main:
    j init

init:
    # get random food position
    jal make_food

    # display food
    after_make_food:
    sw $foodX, 0($io)
    sw $foodY, 1($io)
    sw $zero, 2($io)
    sw $zero, 3($io)

    addi $dir, $zero, 1 # initial direction right
    
    addi $score, $zero, 0 # initial score 0

    addi $tail, $zero, 176
    addi $head, $tail, 3 # initial snake size 3

    # initial snake body
    addi $t0, $zero, 7 # x
    addi $t1, $zero, 7 # y
    sw $t0, 0($tail)
    sw $t1, 1($tail)
    addi $t0, $zero, 8
    addi $t1, $zero, 7
    sw $t0, 2($tail)
    sw $t1, 3($tail)
    addi $t0, $zero, 9
    addi $t1, $zero, 7
    sw $t0, 4($tail)
    sw $t1, 5($tail)
    addi $t0, $zero, 10
    addi $t1, $zero, 7
    sw $t0, 6($tail)
    sw $t1, 7($tail)


make_food:
    lw $foodX, 15($io)
    lw $foodY, 15($io)
    andi $foodX, $foodX, 31
    andi $foodY, $foodY, 15

draw_food:
    sw $foodX, 0($io)
    sw $foodY, 1($io)
    sw $zero, 2($io)
    sw $zero, 3($io)

draw_snake:
    addi $t0, $tail, 0 # loop index
    j draw_snake_loop
    sw $zero, 2($io) # update display

draw_snake_loop:
    lw $t1, 0($t0) # x of snake body
    lw $t2, 1($t0) # y of snake body
    sw $t1, 0($io) # send x to display
    sw $t2, 1($io) # send y to display
    addi $t0, $t0, 8 # next body
    bne $t0, $head, draw_snake_loop
    j after_draw_snake